!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).modjool={})}(this,(function(e){"use strict";function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function r(e){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?n(Object(o),!0).forEach((function(n){t(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=a(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw o}}}}var l={config:{tag:"no-name",attr:[],shadowDom:!1,modjoolId:!0,scopedCss:!0,unhide:!1,reactive:!0,enter:void 0,ready:void 0,js:void 0,complete:void 0,leave:void 0,html:()=>"",css:()=>""},warnings:[],classes:[],elements:[],addElement(e){this.elements.push(e)},removeElement(e){this.elements=this.elements.filter(t=>t!==e)},getElements(e){return e?this.elements.filter(t=>t.mj.tag===e):this.elements}};function s(e){"interactive"===document.readyState||"complete"===document.readyState?e():document.addEventListener("DOMContentLoaded",()=>{e()})}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t=1===t.length?t[0]:t,Array.isArray(t)){if(0===t.length)return f(e);var r,o=[],a=c(t);try{for(a.s();!(r=a.n()).done;){var i=r.value;o.push(d(e,i,n))}}catch(e){a.e(e)}finally{a.f()}return Promise.all(o).then(e=>!!e.every(e=>!1!==e)&&e)}return d(e,t,n)}function d(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r="string"==typeof t||t instanceof String;return e(t,!r).then(e=>{if(!0!==n)return e.class||!1;try{customElements.define(e.tag,e.class)}catch(e){console.error(e)}return!!customElements.get(e.tag)&&e.options})}var m=[];function f(e){var t,n=document.querySelectorAll(":not(:defined)"),r=[],o=c(n);try{for(o.s();!(t=o.n()).done;){var a=t.value,i=a.tagName.toLowerCase()||a.nodeName.toLowerCase()||a.localName;r.includes(i)||m.includes(i)||(m.push(i),r.push(i))}}catch(e){o.e(e)}finally{o.f()}return new Promise(t=>{s(()=>{r.length?t(u(e,r,!0)):t(!1)})})}function v(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e.mj,i=null,c=a.runningLifecycle;return c||(a.runningLifecycle=!0),a.new&&null!==a.new[n]&&void 0!==a.new[n]&&(i=a.new[n]()||void 0),null===i&&void 0!==t[n]&&(i=(o?t[n](r(r({},a.instance),o)):t[n](a.instance))||void 0),c||(a.runningLifecycle=!1),i}function j(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(t){var r;if("string"==typeof t||t instanceof String)r=t;else{r=t[0];for(var o=0;o<(arguments.length<=1?0:arguments.length-1);o++)r+=(o+1<1||arguments.length<=o+1?void 0:arguments[o+1])+t[o+1]}return n?e.mj.body.querySelectorAll(r):e.mj.body.querySelector(r)}}var h=b(),y=b(!0);function b(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t={},n={};return e?function(e){if(t[e])return t[e];if(e===e.toLowerCase())return e;var r=e.replace(/[A-Z]/g,"-$&").toLowerCase();return t[e]=r,n[r]=e,r}:function(e){if(n[e])return n[e];if(!e.includes("-"))return e;var r=e.split("-").map((e,t)=>t?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():e.toLowerCase()).join("");return n[e]=r,t[r]=e,r}}function g(e,t){if(e.isConnected){e.mj.settingAttributes=!0,e.mj.attributes={};for(var n=0;n<e.attributes.length;n++){var r=e.attributes[n].nodeName.toLowerCase();if(!r.toLowerCase().startsWith("mj-")){var a=e.attributes[n].nodeValue;""===a&&(a=!0),e.mj.attributes[h(r)]=a}}!function(e,t,n){for(var r=e.mj.instance.attr,a=0,i=Object.keys(r);a<i.length;a++){delete r[i[a]]}for(var c=0,l=Object.entries(n);c<l.length;c++){var s=o(l[c],2),u=s[0],d=s[1];r[u]=d}}(e,0,e.mj.attributes),e.mj.settingAttributes=!1}}function p(e,t){if(e.isConnected){var n=function(e,t){var n,r,o="mj-8Wi7fiDtPtAWMhLQop1Smg",a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=document.createDocumentFragment(),r=document.createElement("div");return r.innerHTML=e,r.id=t,n.appendChild(r),n}(e.mj.bodyContent,o).querySelectorAll("#".concat(o," > [slot]"));if(a.length>0){n={},r={};var i,l=c(a);try{for(l.s();!(i=l.n()).done;){var s=i.value,u=s.getAttribute("slot");r[u]=s.innerHTML,n[u]=t.shadowDom?'<slot name="'.concat(u,'"></slot>'):s.outerHTML}}catch(e){l.e(e)}finally{l.f()}}else{var d=e.mj.bodyContent.length?"<slot></slot>":"";r=e.mj.bodyContent,n=t.shadowDom?d:e.mj.bodyContent}return{slot:n,slotVal:r}}(e,t),r=n.slot,o=n.slotVal;e.mj.instance.slot=r,e.mj.instance.slotVal=o}}function w(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e.isConnected&&(!e.mj.runningLifecycle||n)){var r=L(e,t),o=S(e,t),a=r+o;if(a!==e.mj.currentBody){var i=document.createDocumentFragment();C(i,r),A(i,o,e,t),O(e.mj.body),e.mj.body.appendChild(i),e.mj.currentBody=a}}}function C(e,t){if(t){var n=document.createElement("template");n.innerHTML=t,e.appendChild(n.content)}}function A(e,t,n,r){var o,a,i=r.scopedCss;if(t){var c=document.createElement("style");c.setAttribute("id","mj-style-".concat(n.mj.id)),c.textContent=i?(o=n.mj.instance.self.select,a=/(?!.*@media)[\t ]*([a-zA-Z#.:*[][^{/]*\s*){[\s\S]*?}/gm,t.replace(a,(e,t)=>{var n=t.trimStart().split(",");return e=e.trimStart(),function(e,t,n){for(var r in n){var o=/:self\(([^\s]*)\)/im,a=n[r].match(o);a?n[r]=n[r].replace(a[0],e(a[1])):n[r].includes(":self")?n[r]=n[r].replace(":self",e()):n[r]="".concat(e()," ").concat(n[r])}return n}(o,0,n).join(", ")+e.slice(t.length)})):t,e.appendChild(c)}}function L(e,t){var n=t.html;return e.mj.new.html?e.mj.new.html(r({},e.mj.instance)):n(r({},e.mj.instance))||e.mj.bodyContent}function S(e,t){var n=t.css;return e.mj.new.css?e.mj.new.css(r({},e.mj.instance)):n(r({},e.mj.instance))||e.mj.styleContent}function O(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function E(e,t,n){for(var r=0,a=Object.entries(n);r<a.length;r++){var i=o(a[r],2),c=i[0],l=i[1];e.mj.new[c]=l,w(e,t)}}var V={advanced:function(e,t,n){var r=n.attrName,o=n.oldVal,a=void 0===o?"":o,i=n.newVal,c=void 0===i?"":i,l=[e,t];if(!0===e.mj.loaded&&a!==c){var s="attr_"+h(r);g(...l),v(e,t,s,{oldVal:a,newVal:c}),e.mj.runningLifecycle||(w(...l),v(...l,"complete"))}},simple:function(){}};function M(e,t){var n=new MutationObserver(n=>{n.forEach(n=>{"attributes"===n.type&&e.mj.loaded&&(n.attributeName.startsWith("mj-")||V.advanced(e,t,{attrName:n.attributeName,oldVal:n.oldValue,newVal:e.getAttribute(n.attributeName)}))})});return n.observe(e,{attributes:!0,attributeOldValue:!0}),n}var P=["tag","shadowDom","reactive","modjoolId","unhide","scopedCss","enter","data","ready","js","complete","leave","html","css"];var D={advanced:function(e,t){var n=Math.random().toString(36).slice(-6);e.mj={tag:t.tag,id:n,attributes:{},observer:{},body:{},bodyContent:"",styleContent:"",currentBody:"",runningLifecycle:!1,settingAttributes:!1,loaded:!1,reactiveAttributes:t.attributes,instance:{attr:{},data:{},elem:{},find:j(e,t),findAll:j(e,t,!0),self:{id:n,tag:t.tag,options:t,select:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t.shadowDom?":host(".concat(t.tag,'[mj-id="').concat(n,'"]').concat(e,")"):"".concat(t.tag,'[mj-id="').concat(n,'"]').concat(e)},element:{},update:()=>{w(e,t,!0),e.mj.runningLifecycle||v(e,t,"complete")},updateSlot:()=>p(e,t),updateAttr:()=>g(e),updateAll:()=>{!function(){g(...arguments),p(...arguments),w(...arguments)}(e,t,!0),e.mj.runningLifecycle||v(e,t,"complete")},remove:()=>e.mj.body.host?e.mj.body.host.remove():e.mj.body.remove(),css:n=>E(e,t,{css:n}),data:n=>E(e,t,{data:n}),enter:n=>E(e,t,{enter:n}),html:n=>E(e,t,{html:n}),js:n=>E(e,t,{js:n}),complete:n=>E(e,t,{complete:n}),leave:n=>E(e,t,{leave:n}),ready:n=>E(e,t,{ready:n}),attrHook:(n,r)=>{t.attr.length||e.mj.observer||(e.mj.observer=M(e,t)),E(e,t,{["attr_"+n]:r})},dataHook:(n,r)=>{E(e,t,{["data_"+n]:r})}},slot:{},slotVal:{}},new:{css:null,data:null,enter:null,html:null,js:null,leave:null,ready:null},options:t},t.reactive&&(e.mj.instance.attr=function(e,t){return new Proxy(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{set(t,n,r){return e.mj.settingAttributes||e.setAttribute(y(n),r),Reflect.set(...arguments)}})}(e,t,{}),e.mj.instance.data=function(e,t){return new Proxy(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{set(n,r,o){if(e.mj.dataInit)return Reflect.set(...arguments);var a,i=v(e,t,"data_"+r,{oldVal:n[r],newVal:o});return a=null!=i?Reflect.set(n,r,i):Reflect.set(...arguments),e.mj.runningLifecycle||(w(e,t),v(e,t,"complete")),a}})}(e,t,{}),!t.attr.length&&function(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];if(!P.includes(r))return!0}return!1}(t)&&(e.mj.observer=M(e,t))),t.shadowDom?(e.attachShadow({mode:"open"}),e.mj.body=e.shadowRoot):e.mj.body=e,e.mj.instance.self.element=e.mj.body.host?e.mj.body.host:e.mj.body,e.mj.instance.elem=e.mj.instance.self.element,e.mj.constructorRun=!0,v(e,t,"enter")},simple:function(){}};var T={advanced:function(e,t){return void 0!==t.attr?t.attr.map(e=>{if(e=e.toLowerCase(),!P.includes(e))return e;console.error("[Modjool] ERROR: Keyword used as element attribute name [".concat(e,"]"))}):[]},simple:function(){}};var I={advanced:function(e,t){null!==v(e,t,"js",{adopted:!0})&&w(e,t),v(e,t,"complete")},simple:function(){}};var x={advanced:function(e,t){var n=[e,t];if(!e.mj.alreadyConnected){var r=function(){e.mj.bodyContent=e.innerHTML,function(e,t){t.modjoolId&&e.setAttribute("mj-id",e.mj.id)}(...n),g(...n),p(...n),function(e,t,n){if(null===n)return null;e.mj.dataInit=!0;for(var r=0,a=Object.entries(n);r<a.length;r++){var i=o(a[r],2),c=i[0],l=i[1];e.mj.instance.data[c]=l}e.mj.dataInit=!1}(...n,e.mj.new&&e.mj.new.data||v(e,t,"data")||{}),v(e,t,"ready"),w(...n),function(e,t){t.unhide&&e.removeAttribute("hidden")}(...n),e.mj.loaded=!0,v(e,t,"js"),function(e,t){e.mj.instance&&(e.mj.runningLifecycle=!0,n(),r(),e.mj.runningLifecycle=!1);function n(){for(var n in e.mj.attributes){var r="attr_"+n,o=e.mj.attributes[n];v(e,t,r,{newVal:o})}}function r(){for(var n in e.mj.dataInit=!0,e.mj.instance.data){var r="data_"+n,o=e.mj.instance.data[n],a=v(e,t,r,{newVal:o});null!=a&&(e.mj.instance.data[n]=a)}e.mj.dataInit=!1}}(e,t),w(e,t),v(e,t,"complete"),l.addElement(e),e.dispatchEvent(new Event("mj-defined"))};e.mj.alreadyConnected=!0,t.shadowDom?r():function e(t,n){if(t.mj.constructorRun)try{var r=t.closest(":not(:defined)");if(null===r)n();else{var o=()=>{e(t,n),r.removeEventListener("mj-defined",o)};r.addEventListener("mj-defined",o)}}catch(e){!l.warnings.includes(":defined")&&e.toString().includes(":defined")?(l.warnings.push(":defined"),console.warn("[Modjool] Browser does not support :defined CSS selector, possible custom element nesting bugs"),n()):console.error(e)}}(e,()=>r())}},simple:function(e,t){e.mj={},e.mj.tag=t.tag,l.addElement(e),e.dispatchEvent(new Event("mj-defined"))}};var H={advanced:function(e,t){v(e,t,"leave"),e.mj.body.innerHTML="",e.mj.observer&&e.mj.observer.disconnect&&e.mj.observer.disconnect(),l.removeElement(e)},simple:function(e,t){l.removeElement(e)}};function N(e,t){return t&&(e=r(r({},l.config),e)),new Promise((n,r)=>{s(()=>{n(function(e,t){var n=t?"advanced":"simple";class r extends HTMLElement{constructor(){var t=super(...arguments);return this.mj={},D[n](this,e),t}static get observedAttributes(){return T[n](this,e)}attributeChangedCallback(t,r,o){V[n](this,e,{attrName:t,oldVal:r,newVal:o})}connectedCallback(){x[n](this,e)}adoptedCallback(){I[n](this,e)}disconnectedCallback(){H[n](this,e),this.mj={}}}return{tag:t?e.tag:e,options:e,class:r}}(e,t))})})}var R={create:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return u(N,t,!0)},createClass:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return u(N,t,!1)},createUndefined:function(){return u(N,[],!0)},options:function(e){return l.config=r(r({},l.config),e),l.config},get:k,getAsync:function(e){return q().then(()=>k(e))},getUndefined:_,getUndefinedAsync:function(){return q().then(()=>_())},complete:function(e){q().then(()=>e())},wait:q};function k(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return l.getElements(e)}function _(){return document.querySelectorAll(":not(:defined)")}function q(){return new Promise((e,t)=>{"interactive"===document.readyState||"complete"===document.readyState?setTimeout(()=>{e()},0):document.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>{e()},1)})})}var U={create:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return u(B,t)}};function B(e){class t extends HTMLElement{constructor(){return super(...arguments)}}return{tag:e,options:e,class:t}}e.modjool=R,e.modjoolLite=U,Object.defineProperty(e,"__esModule",{value:!0})}));//# sourceMappingURL=modjool.umd.js.map
