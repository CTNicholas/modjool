{"version":3,"file":"modjool-lite.js","sources":["../src/modjool/create.js","../src/modjool/whenready.js","../src/modjool/modjoolLite.js"],"sourcesContent":["import whenReady from './whenready.js'\r\n\r\n/**\r\n * Defines or creates custom element classes from createElement function.\r\n * Return value wrapped in Promise\r\n *\r\n * If define === true:\r\n *   Create and define custom elements\r\n *   Return result (options object or array of option objects used for Modjool definition)\r\n *\r\n * If define === false:\r\n *   Create custom element classes, but do not define\r\n *   Return result (class or array of classes to be used for custom element definition)\r\n *\r\n * Execution process:\r\n *   1. If options not passed, define all elements not currently defined, return true\r\n *   2. If array passed, define all elements, return array of results\r\n *   3. Else, create single element, if successful, return result\r\n *   4. Return false if problem\r\n *\r\n * @param {Function} createElement - Function to build ModjoolElement or ModjoolLiteElement\r\n * @param {Object|Array|String} options - Options provided by modjool.create()\r\n * @param {Boolean} define - Will define element, and return options if true\r\n * @returns {Promise<Object|Class|Array<Object|Class>|Boolean>} - See above. All 3 processes return false if failed\r\n */\r\nexport default function creator (createElement, options = [], define = true) {\r\n  options = options.length === 1 ? options[0] : options\r\n  if (Array.isArray(options)) {\r\n    if (options.length === 0) {\r\n      return defineAll(createElement)\r\n    }\r\n    const result = []\r\n    for (const option of options) {\r\n      result.push(createSingle(createElement, option, define))\r\n    }\r\n    return Promise.all(result).then(values => {\r\n      const allSuccessful = values.every(res => res !== false)\r\n      return allSuccessful ? values : false\r\n    })\r\n  } else {\r\n    return createSingle(createElement, options, define)\r\n  }\r\n}\r\n\r\n/**\r\n * Creates a single ModjoolElement or ModjoolLiteElement. If a string is passed as options,\r\n * send false to createElement(), to denote a simple API call. If define === true,\r\n * returns the class instead of defining and returning options.\r\n * Return value wrapped in Promise\r\n * @param {Function} createElement - Function to build ModjoolElement or ModjoolLiteElement\r\n * @param {Object|String} options - Options provided by modjool.create()\r\n * @param {Boolean} define - Will define element, and return options if true\r\n * @returns {Promise<Object|Class|false>} - True if successful, false if not\r\n */\r\nfunction createSingle (createElement, options, define = true) {\r\n  const isString = typeof options === 'string' || options instanceof String\r\n  return createElement(options, !isString).then(customElement => {\r\n    if (define !== true) {\r\n      return customElement.class || false\r\n    }\r\n    try {\r\n      customElements.define(customElement.tag, customElement.class)\r\n    } catch (err) {\r\n      console.error(err)\r\n    }\r\n    return customElements.get(customElement.tag) ? customElement.options : false\r\n  })\r\n}\r\n\r\n/**\r\n * Finds all non-defined custom elements, and defines them using createSingle()\r\n * @param {Function} createElement - Function to build ModjoolElement or ModjoolLiteElement\r\n * @returns {Promise} - List of all successfully defined custom element options objects\r\n */\r\nconst definedEls = []\r\nfunction defineAll(createElement) {\r\n  const notDefined = document.querySelectorAll(':not(:defined)')\r\n  const list = []\r\n  for (const el of notDefined) {\r\n    const tag = el.tagName.toLowerCase() || el.nodeName.toLowerCase() || el.localName\r\n    if (!list.includes(tag) && !definedEls.includes(tag)) {\r\n      definedEls.push(tag)\r\n      list.push(tag)\r\n    }\r\n  }\r\n  return new Promise(resolve => {\r\n    whenReady(() => {\r\n      if (list.length) {\r\n        resolve(creator(createElement, list, true))\r\n      } else {\r\n        resolve(false)\r\n      }\r\n    })\r\n  })\r\n}\r\n","/**\r\n * Runs func when the entire DOM has loaded\r\n * @param {Function} func - The function to be run\r\n */\r\nexport default function (func) {\r\n  if (document.readyState === 'interactive' || document.readyState === 'complete') {\r\n    func()\r\n  } else {\r\n    document.addEventListener('DOMContentLoaded', () => {\r\n      func()\r\n    })\r\n  }\r\n}\r\n","/* global customElements, HTMLElement */\r\nimport createElement from './create.js'\r\n\r\nexport default { create }\r\n\r\n/**\r\n * Creates one or more ModjoolLite elements, using the ModjoolLite API\r\n * @param  {...Array|String} options - One of two inputs:\r\n *   1. An array of strings for the simple API\r\n *   2. A single string for the simple API\r\n * @returns {Boolean} - True if successful, false if not\r\n */\r\nfunction create (...options) {\r\n  return createElement(modjoolLiteElement, options)    \r\n}\r\n\r\n/**\r\n * Creates and defines a ModjoolLite element\r\n * @param {String} elementName - The tag of the custom element\r\n * @returns {Object} - The defined class, tag, and options\r\n */\r\nfunction modjoolLiteElement (elementName) {\r\n  // noinspection JSUnusedLocalSymbols\r\n  class ModjoolLiteElement extends HTMLElement {\r\n    constructor (...args) {\r\n      // noinspection all\r\n      return super(...args)\r\n    }\r\n  }\r\n  return {\r\n    tag: elementName,\r\n    options: elementName,\r\n    class: ModjoolLiteElement\r\n  }\r\n}\r\n"],"names":["creator","createElement","options","define","length","Array","isArray","defineAll","result","option","push","createSingle","Promise","all","then","values","every","res","isString","String","customElement","class","customElements","tag","err","console","error","get","definedEls","notDefined","document","querySelectorAll","list","el","tagName","toLowerCase","nodeName","localName","includes","resolve","func","readyState","addEventListener","modjoolLiteElement","elementName","ModjoolLiteElement","HTMLElement","constructor","super","create"],"mappings":"4/BAyBe,SAASA,EAASC,OAAeC,yDAAU,GAAIC,gEAC5DD,EAA6B,IAAnBA,EAAQE,OAAeF,EAAQ,GAAKA,EAC1CG,MAAMC,QAAQJ,GAAU,IACH,IAAnBA,EAAQE,cACHG,EAAUN,SAEbO,EAAS,OACMN,kCAAS,KAAnBO,UACTD,EAAOE,KAAKC,EAAaV,EAAeQ,EAAQN,0CAE3CS,QAAQC,IAAIL,GAAQM,KAAKC,KACRA,EAAOC,MAAMC,IAAe,IAARA,IACnBF,UAGlBJ,EAAaV,EAAeC,EAASC,GAchD,SAASQ,EAAcV,EAAeC,OAASC,6DACvCe,EAA8B,iBAAZhB,GAAwBA,aAAmBiB,cAC5DlB,EAAcC,GAAUgB,GAAUJ,KAAKM,QAC7B,IAAXjB,SACKiB,EAAcC,QAAS,MAG9BC,eAAenB,OAAOiB,EAAcG,IAAKH,EAAcC,OACvD,MAAOG,GACPC,QAAQC,MAAMF,WAETF,eAAeK,IAAIP,EAAcG,MAAOH,EAAclB,UASjE,IAAM0B,EAAa,GACnB,SAASrB,EAAUN,SACX4B,EAAaC,SAASC,iBAAiB,kBACvCC,EAAO,OACIH,kCAAY,KAAlBI,UACHV,EAAMU,EAAGC,QAAQC,eAAiBF,EAAGG,SAASD,eAAiBF,EAAGI,UACnEL,EAAKM,SAASf,IAASK,EAAWU,SAASf,KAC9CK,EAAWlB,KAAKa,GAChBS,EAAKtB,KAAKa,0CAGP,IAAIX,QAAQ2B,ICjFN,IAAUC,EAAAA,EDkFX,KACJR,EAAK5B,OACPmC,EAAQvC,EAAQC,EAAe+B,GAAM,IAErCO,GAAQ,ICrFc,gBAAxBT,SAASW,YAAwD,aAAxBX,SAASW,WACpDD,IAEAV,SAASY,iBAAiB,mBAAoB,KAC5CF,QCYN,SAASG,EAAoBC,SAErBC,UAA2BC,YAC/BC,qBAESC,2BAGJ,CACLzB,IAAKqB,EACL1C,QAAS0C,EACTvB,MAAOwB,SA7BI,CAAEI,OASjB,sCAAoB/C,2BAAAA,yBACXD,EAAc0C,EAAoBzC"}